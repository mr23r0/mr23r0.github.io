<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="robots" content="index, follow">

  <title>OAuth Implementation Vulnerabilities - Chapter One</title><!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="OAuth Implementation Vulnerabilities - Chapter One" />
<meta name="author" content="Saransh Saraf" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="OAuth Implementation Vulnerabilities - Most of the time applications become vulnerable to serious threats and issues just by forgetting to add a couple lines of code, this series explores the vulnerabilites in the same gener." />
<meta property="og:description" content="OAuth Implementation Vulnerabilities - Most of the time applications become vulnerable to serious threats and issues just by forgetting to add a couple lines of code, this series explores the vulnerabilites in the same gener." />
<link rel="canonical" href="http://localhost:4000/oauth-implementation-vulnerabilities-part-one" />
<meta property="og:url" content="http://localhost:4000/oauth-implementation-vulnerabilities-part-one" />
<meta property="og:site_name" content="[mr23r0] Saransh Saraf" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-04-27T00:00:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="OAuth Implementation Vulnerabilities - Chapter One" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/oauth-implementation-vulnerabilities-part-one"},"author":{"@type":"Person","name":"Saransh Saraf"},"url":"http://localhost:4000/oauth-implementation-vulnerabilities-part-one","@type":"BlogPosting","description":"OAuth Implementation Vulnerabilities - Most of the time applications become vulnerable to serious threats and issues just by forgetting to add a couple lines of code, this series explores the vulnerabilites in the same gener.","headline":"OAuth Implementation Vulnerabilities - Chapter One","dateModified":"2024-04-27T00:00:00+05:30","datePublished":"2024-04-27T00:00:00+05:30","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="[mr23r0] Saransh Saraf" /><link rel="shortcut icon" type="image/x-icon" href="/assets/favicon/logo.png" />
  <link rel="stylesheet" href="/assets/css/main.css" />
</head><body a="auto">
    <main class="page-content" aria-label="Content">
      <div class="w">
        <head>
  <meta name="robots" content="index, follow">
  <meta name="description" content="OAuth Implementation Vulnerabilities - Most of the time applications become vulnerable to serious threats and issues just by forgetting to add a couple lines of code, this series explores the vulnerabilites in the same gener.">
  <meta name="keywords" content="">
  <meta name="author" content="Saransh Saraf">
</head><header>
    <h1>[mr23r0] Saransh Saraf</h1><dir style="text-align: left; display: flex; justify-content: center;">
      
      <p style="margin-inline: 4px;  text-decoration: none; text-transform: capitalize; background-color: #07b10f;"><a href="/archive">posts</a></p>
      
      <p style="margin-inline: 4px;  text-decoration: none; text-transform: capitalize;"><a href="/resources-archive">resources</a></p>
      
      <p style="margin-inline: 4px;  text-decoration: none; text-transform: capitalize;"><a href="/guides-archive">guides</a></p>
      
      <p style="margin-inline: 4px;  text-decoration: none; text-transform: capitalize;"><a href="/books-archive">books</a></p>
      
    </dir>
  </header>
<a href="/">../</a><article>
  <p class="post-meta">
    <time datetime="2024-04-27 00:00:00 +0530">2024-04-27</time>
  </p>


  <h1>OAuth Implementation Vulnerabilities - Chapter One</h1>

  <p>In mostly all applications these day, there’s atleast one button for social login, like Google, Microsoft, Slack, Github or Linkedin. while it gives the ability to register and login into the applications pretty easily but like everything else in this world it also comes with multiple complications and potential ground breaking security issues for that application.</p>

<p>These type of features can have a large number of implementation issues which can’t be explained in a single post, therefore I’ve divided this in multiple chapters, which be released one by one in upcoming weeks.</p>

<p>Before I dive into the details, I would recommend you to watch this amazing BlackHat session on <a href="https://www.youtube.com/watch?v=77doS9hCe8A" target="_blank">“The Accidental Discovery of a New Vulnerability in Google’s OAuth Implementation”</a> by <a href="https://www.linkedin.com/in/bsmithsweeney/" target="_blank">Brian Smith-Sweeney</a> which was the major spark for this post and small research.</p>

<p>Assuming that you’ve watched the session, let’s dive a bit deeper into the entire workflow of tokens.</p>

<p>With oauth 2.0 people grant two type of tokens, which has it’s own unique use,</p>
<ul>
  <li>ID Tokens</li>
  <li>Access Tokens</li>
</ul>

<h3 id="id-tokens">ID Tokens</h3>
<p>In simple terms, ID Tokens are like your identity card for a theme park, they hold your identity information such as email, openid, full name and avatar.</p>

<h3 id="access-tokens">Access Tokens</h3>
<p>Access Tokens are more like special ride passes in the theme park. they hold the permissions that the app needs to access your data or perform actions on your behalf (like accessing your Google Drive or Calendar). Apps use this token to do things for you, like read your emails or add an event to your calendar, depending on what you allowed.</p>

<p>In order to issue a token on behalf of you application, let’s say you want to provide google social sign in and show user’s drive files on your application. In order to do these, you first need to create a oauth consumer on <a href="https://console.cloud.google.com" target="_blank">Google Cloud Platform</a> and then create a handler to on your application to initiate the login (i.e. <code class="language-plaintext highlighter-rouge">/google/oauth/signin</code>), and capture the returned token (i.e. <code class="language-plaintext highlighter-rouge">/google/callback</code>).</p>

<p><img src="/assets/img/gcpCreds.png" alt="&quot;GCP API Credentials&quot;" /></p>

<p>Each created consumer is assigned a <code class="language-plaintext highlighter-rouge">clientID</code> and <code class="language-plaintext highlighter-rouge">secret</code> by google to identify and validate the login requests,</p>


  <div class="container">
  <div class="share-buttons">
    <p>Share with&nbsp;</p>
    <a href="https://twitter.com/intent/tweet?text=Check out this awesome blog post by @mr23r0 https://mr23r0.github.io/oauth-implementation-vulnerabilities-part-one"
      target="_blank">
      <img src="/assets/img/x.png" "alt=" Share on Twitter"
        style="width: 25px; height: 25px; margin-right: 10px;">
    </a>&nbsp;
  </div>
  <div class="share-buttons" >
    <p>Discussions&nbsp;</p>
    <a href="https://discord.com/channels/1156182342226956299/1176565821082959932"
      target="_blank">
      <svg width="24" height="24" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill="none">

        <g fill="#000000">

          <path
            d="M11.25 1a.75.75 0 010 1.5h-9a.75.75 0 00-.75.75v6.531l.706-.51a.75.75 0 01.88 1.214L1.19 11.858A.75.75 0 010 11.25v-8A2.25 2.25 0 012.25 1h9z" />

          <path fill-rule="evenodd"
            d="M6.25 4A2.25 2.25 0 004 6.25v4.534a2.25 2.25 0 002.25 2.25h6.041l2.52 1.824A.75.75 0 0016 14.25v-8A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v6.531l-1.526-1.104a.75.75 0 00-.44-.143H6.25a.75.75 0 01-.75-.75V6.25z"
            clip-rule="evenodd" />

        </g>

      </svg>
    </a>&nbsp;
  </div>
</div>
<div class="share-buttons" >
  <p>Write me your valuable feedback!&nbsp;</p>
  <a href="mailto:waiting4mychocolates@gmail.com?subject=OAuth Implementation Vulnerabilities - Chapter One [Feedback]"
    target="_blank"><svg fill="#000000" height="24" width="24" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
    viewBox="0 0 75.294 75.294" xml:space="preserve">
 <g>
   <path d="M66.097,12.089h-56.9C4.126,12.089,0,16.215,0,21.286v32.722c0,5.071,4.126,9.197,9.197,9.197h56.9
     c5.071,0,9.197-4.126,9.197-9.197V21.287C75.295,16.215,71.169,12.089,66.097,12.089z M61.603,18.089L37.647,33.523L13.691,18.089
     H61.603z M66.097,57.206h-56.9C7.434,57.206,6,55.771,6,54.009V21.457l29.796,19.16c0.04,0.025,0.083,0.042,0.124,0.065
     c0.043,0.024,0.087,0.047,0.131,0.069c0.231,0.119,0.469,0.215,0.712,0.278c0.025,0.007,0.05,0.01,0.075,0.016
     c0.267,0.063,0.537,0.102,0.807,0.102c0.001,0,0.002,0,0.002,0c0.002,0,0.003,0,0.004,0c0.27,0,0.54-0.038,0.807-0.102
     c0.025-0.006,0.05-0.009,0.075-0.016c0.243-0.063,0.48-0.159,0.712-0.278c0.044-0.022,0.088-0.045,0.131-0.069
     c0.041-0.023,0.084-0.04,0.124-0.065l29.796-19.16v32.551C69.295,55.771,67.86,57.206,66.097,57.206z"/>
 </g>
 </svg>
  </a>
</div>
  <style>
    .container {
  display: flex;
  justify-content: space-between;
}
    .share-buttons {
      display: flex;
      align-items: center;
    }
  </style>
</article>
      </div>
    </main>
  </body><footer style="text-align: center">
  <a
    href="https://www.linkedin.com/in/saransh-saraf-2b514b20b/"
    target="_blank"
    rel="noopener noreferrer"
    ><svg
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      viewBox="0 0 24 24"
    >
      <path
        d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"
      /></svg
  ></a>
  <a href="https://twitter.com/MR23R0" target="_blank" rel="noopener noreferrer"
    ><svg
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      viewBox="0 0 24 24"
    >
      <path
        d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"
      /></svg
  ></a>
  <a href="https://mr23r0.medium.com/" target="_blank" rel="noopener noreferrer"
    ><svg
      width="24"
      height="24"
      xmlns="http://www.w3.org/2000/svg"
      fill-rule="evenodd"
      clip-rule="evenodd"
    >
      <path
        d="M2.846 6.887c.03-.295-.083-.586-.303-.784l-2.24-2.7v-.403h6.958l5.378 11.795 4.728-11.795h6.633v.403l-1.916 1.837c-.165.126-.247.333-.213.538v13.498c-.034.204.048.411.213.537l1.871 1.837v.403h-9.412v-.403l1.939-1.882c.19-.19.19-.246.19-.537v-10.91l-5.389 13.688h-.728l-6.275-13.688v9.174c-.052.385.076.774.347 1.052l2.521 3.058v.404h-7.148v-.404l2.521-3.058c.27-.279.39-.67.325-1.052v-10.608z"
      /></svg
  ></a>
  <a
    href="https://www.instagram.com/sarans0x00h/"
    target="_blank"
    rel="noopener noreferrer"
    ><svg
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      viewBox="0 0 24 24"
    >
      <path
        d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"
      /></svg
  ></a>
  <a href="https://discord.com/invite/JWnwgd55ZZ" target="_blank" rel="noopener noreferrer"
    ><svg
      width="24"
      height="24"
      viewBox="0 -28.5 256 256"
      version="1.1"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
      preserveAspectRatio="xMidYMid"
    >
      <g>
        <path
          d="M216.856339,16.5966031 C200.285002,8.84328665 182.566144,3.2084988 164.041564,0 C161.766523,4.11318106 159.108624,9.64549908 157.276099,14.0464379 C137.583995,11.0849896 118.072967,11.0849896 98.7430163,14.0464379 C96.9108417,9.64549908 94.1925838,4.11318106 91.8971895,0 C73.3526068,3.2084988 55.6133949,8.86399117 39.0420583,16.6376612 C5.61752293,67.146514 -3.4433191,116.400813 1.08711069,164.955721 C23.2560196,181.510915 44.7403634,191.567697 65.8621325,198.148576 C71.0772151,190.971126 75.7283628,183.341335 79.7352139,175.300261 C72.104019,172.400575 64.7949724,168.822202 57.8887866,164.667963 C59.7209612,163.310589 61.5131304,161.891452 63.2445898,160.431257 C105.36741,180.133187 151.134928,180.133187 192.754523,160.431257 C194.506336,161.891452 196.298154,163.310589 198.110326,164.667963 C191.183787,168.842556 183.854737,172.420929 176.223542,175.320965 C180.230393,183.341335 184.861538,190.991831 190.096624,198.16893 C211.238746,191.588051 232.743023,181.531619 254.911949,164.955721 C260.227747,108.668201 245.831087,59.8662432 216.856339,16.5966031 Z M85.4738752,135.09489 C72.8290281,135.09489 62.4592217,123.290155 62.4592217,108.914901 C62.4592217,94.5396472 72.607595,82.7145587 85.4738752,82.7145587 C98.3405064,82.7145587 108.709962,94.5189427 108.488529,108.914901 C108.508531,123.290155 98.3405064,135.09489 85.4738752,135.09489 Z M170.525237,135.09489 C157.88039,135.09489 147.510584,123.290155 147.510584,108.914901 C147.510584,94.5396472 157.658606,82.7145587 170.525237,82.7145587 C183.391518,82.7145587 193.761324,94.5189427 193.539891,108.914901 C193.539891,123.290155 183.391518,135.09489 170.525237,135.09489 Z"
          fill-rule="nonzero"
        ></path>
      </g></svg
  ></a>
  <p style="text-align: center">Theme by Jekyll + Customizations</p>
</footer>
</html>